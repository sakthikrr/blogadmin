import{A as b,Aa as gt,B as a,C as F,D as A,E as H,F as Q,G as c,H as W,J as M,K as J,L as C,M as Z,N as K,R as X,S as Y,T as tt,U as et,a as O,aa as E,b as G,ba as $,ca as k,d as R,da as T,e as P,ea as it,f as z,fa as U,ga as N,h as y,ha as j,i as I,ia as L,j as x,ja as ot,k as S,ka as st,la as rt,m as q,ma as nt,n as l,na as lt,o as f,oa as at,qa as pt,ra as B,s as g,t as p,ta as mt,u as _,ua as dt,v as s,va as ct,w as r,x as m,xa as ut,y as w,ya as ft,z as h,za as ht}from"./chunk-EQ75MV27.js";import"./chunk-MON7YFGF.js";var _t={production:!1,apiUrl:"https://www.api.saktech.online/wp-json/wp/v2/"};var V=(()=>{class o{constructor(e){this.httpcli=e,this.baseUrl=_t.apiUrl,this.username="od5bp",this.appPassword="wxNQ vGTr HET4 W61D 2z0L zV0Z",this.authHeader="Basic "+btoa(this.username+":"+this.appPassword)}getPosts(){return this.httpcli.get(`${this.baseUrl}posts`)}getSinglePost(e){return this.httpcli.get(`${this.baseUrl}posts/${e}`)}postQuickUpdate(e,t){let i=`${this.baseUrl}posts/${e}`,n=new C({"Content-Type":"application/json",Authorization:this.authHeader});return this.httpcli.put(i,t,{headers:n})}getPostFeatureImage(e){let t=`${this.baseUrl}media/${e}`;return this.httpcli.get(t)}postUpdate(e,t){let i=`${this.baseUrl}posts/${e}`,n=new C({"Content-Type":"application/json",Authorization:this.authHeader});return this.httpcli.put(i,t,{headers:n})}postCategoryList(){let e=`${this.baseUrl}categories`;return this.httpcli.get(e).pipe(O(t=>t.map(i=>({id:i.id,name:i.name,slug:i.slug,description:i.description,count:i.count}))))}postStatusList(){let e=`${this.baseUrl}statuses`,t=new C({"Content-Type":"application/json",Authorization:this.authHeader});return this.httpcli.get(e,{headers:t}).pipe(G(i=>console.log("Fetched statuses:",Object.keys(i))),O(i=>Object.keys(i).map(n=>({name:i[n].name,public:i[n].public,protected:i[n].protected,private:i[n].private,queryable:i[n].queryable,slug:i[n].slug}))))}getMediaById(e){return this.httpcli.get(`${this.baseUrl}/media/${e}`)}uploadMedia(e){let t=`${this.baseUrl}media`,i=new FormData;i.append("file",e);let n=new C({Authorization:this.authHeader});return this.httpcli.post(t,i,{headers:n})}static{this.\u0275fac=function(t){return new(t||o)(z(Z))}}static{this.\u0275prov=R({token:o,factory:o.\u0275fac,providedIn:"root"})}}return o})();var Ft=()=>({"min-width":"50rem"}),Mt=()=>[10,25,50],Et=()=>({width:"25rem"}),kt=()=>({"background-color":"#9c27b0",border:"none"}),Tt=o=>["edit-post",o];function Ut(o,u){o&1&&(s(0,"tr",15)(1,"th",16),a(2,"ID"),r(),s(3,"th",17),a(4,"Title"),r(),s(5,"th",18),a(6,"Slug"),r(),s(7,"th",19),a(8,"Actions"),r()())}function Nt(o,u){if(o&1){let e=w();s(0,"tr",15)(1,"td",20),a(2),r(),s(3,"td",21),a(4),r(),s(5,"td",22),a(6),r(),s(7,"td",20)(8,"div",23)(9,"button",24),h("click",function(){let i=x(e).$implicit,n=b();return S(n.showDialog(i.id))}),r(),m(10,"button",25),r()()()}if(o&2){let e=u.$implicit;l(2),F(e.id),l(2),F(e.title),l(2),F(e.slug),l(4),p("routerLink",W(4,Tt,e.id))}}function jt(o,u){o&1&&(s(0,"div",29),m(1,"i",30),s(2,"span"),a(3,"Post updated successfully!"),r()())}function Lt(o,u){o&1&&(s(0,"div",26)(1,"p-messages",27),g(2,jt,4,0,"ng-template",28),r()())}var vt=(()=>{class o{constructor(e){this.postser=e,this.PostListdata=[],this.PostsList=[],this.showSuccessMessage=!1,this.visible=!1,this.postquickedit=new it({post_title:new U(""),post_slug:new U(""),post_id:new U("")})}ngOnInit(){this.postser.getPosts().subscribe(e=>{this.PostsList=e,this.createIdSlugArray()})}createIdSlugArray(){this.PostListdata=this.PostsList.map(e=>({id:e.id,slug:e.slug,title:e.title.rendered}))}showDialog(e){this.showSuccessMessage=!1,this.postser.getSinglePost(e).subscribe({next:t=>{this.postquickedit.patchValue({post_title:t?.title?.rendered||"",post_slug:t?.slug||"",post_id:t.id}),this.visible=!0},error:t=>{console.error("Failed to fetch the post:",t)}})}onSubmit(){let e={id:this.postquickedit.value.post_id,title:this.postquickedit.value.post_title,slug:this.postquickedit.value.post_slug};this.postser.postQuickUpdate(this.postquickedit.value.post_id,e).subscribe({next:t=>{console.log(t),this.showSuccessMessage=!0},error:t=>{console.error("Failed to update the post:",t)}})}static{this.\u0275fac=function(t){return new(t||o)(f(V))}}static{this.\u0275cmp=y({type:o,selectors:[["app-postlist"]],decls:18,vars:19,consts:[[1,"card","surface-0","shadow-1","border-round","m-2"],["styleClass","p-datatable-sm p-datatable-gridlines p-datatable-striped","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries","responsiveLayout","scroll",3,"value","tableStyle","paginator","rows","showCurrentPageReport","rowsPerPageOptions"],["pTemplate","header"],["pTemplate","body"],["header","Post Quick Edit",3,"visibleChange","modal","visible","closable"],["class","mb-3",4,"ngIf"],[3,"ngSubmit","formGroup"],[1,"field"],["for","ptitle",1,"block","mb-2"],["id","ptitle","type","text","pInputText","","formControlName","post_title",1,"w-full"],["for","pslug",1,"block","mb-2"],["id","pslug","type","text","pInputText","","formControlName","post_slug",1,"w-full"],["id","post_id","type","hidden","formControlName","post_id"],[1,"mt-3","text-right"],["pButton","","type","submit","label","Submit"],[1,"flex","w-full"],[1,"flex-shrink-0","w-2","text-left"],[1,"flex-grow-1","w-5","text-left"],[1,"flex-grow-1","w-4","text-left"],[1,"flex-shrink-0","w-2","text-center"],[1,"flex-shrink-0","w-2"],[1,"flex-grow-1","w-5"],[1,"flex-grow-1","w-4"],[1,"flex","gap-2","justify-content-center"],["pButton","","pRipple","","type","button","icon","pi pi-file-edit","pTooltip","Quick Edit","tooltipPosition","top",1,"p-button-rounded","p-button-text",3,"click"],["pButton","","pRipple","","type","button","icon","pi pi-pencil","pTooltip","Full Edit","tooltipPosition","top",1,"p-button-rounded","p-button-text",3,"routerLink"],[1,"mb-3"],["severity","success"],["pTemplate","content"],[1,"flex","align-items-center"],[1,"pi","pi-check-circle","mr-2"]],template:function(t,i){t&1&&(s(0,"div",0)(1,"p-table",1),g(2,Ut,9,0,"ng-template",2)(3,Nt,11,6,"ng-template",3),r()(),s(4,"p-dialog",4),Q("visibleChange",function(d){return H(i.visible,d)||(i.visible=d),d}),g(5,Lt,3,0,"div",5),s(6,"form",6),h("ngSubmit",function(){return i.onSubmit()}),s(7,"div",7)(8,"label",8),a(9,"Post Title:"),r(),m(10,"input",9),r(),s(11,"div",7)(12,"label",10),a(13,"Post Title:"),r(),m(14,"input",11),r(),m(15,"input",12),s(16,"div",13),m(17,"button",14),r()()()),t&2&&(l(),p("value",i.PostListdata)("tableStyle",c(15,Ft))("paginator",!0)("rows",10)("showCurrentPageReport",!0)("rowsPerPageOptions",c(16,Mt)),l(3),_(c(17,Et)),p("modal",!0),A("visible",i.visible),p("closable",!0),l(),p("ngIf",i.showSuccessMessage),l(),p("formGroup",i.postquickedit),l(11),_(c(18,kt)))},dependencies:[M,pt,tt,Y,lt,rt,mt,ut,N,E,k,T,j,L]})}}return o})();var Dt=()=>({height:"320px",width:"100%"}),Vt=()=>({height:"6px"});function Ot(o,u){if(o&1){let e=w();s(0,"div",22),m(1,"img",23),s(2,"div",24)(3,"p-button",25),h("onClick",function(){x(e);let i=b();return S(i.removeImage())}),r()()()}if(o&2){let e=b();l(),p("src",e.featureImageUrl,q)}}function $t(o,u){if(o&1){let e=w();s(0,"div")(1,"p-fileUpload",26),h("onSelect",function(i){x(e);let n=b();return S(n.onFileSelect(i))}),r(),s(2,"small",27),a(3,"Max file size: 5MB. Allowed file types: JPEG, PNG, GIF"),r()()}o&2&&(l(),p("auto",!1)("maxFileSize",5e6))}function Bt(o,u){o&1&&(s(0,"div",28),m(1,"p-progressBar",29),s(2,"small",30),a(3,"Uploading image..."),r()()),o&2&&(l(),_(c(2,Vt)))}var xt=(()=>{class o{constructor(e,t,i,n){this.fb=e,this.route=t,this.postservice=i,this.messageService=n,this.category_list=[],this.post_status=[],this.categories=[],this.featureImageUrl="",this.uploadedFiles=[],this.uploadInProgress=!1,this.featureImageId=0,this.postForm=this.fb.group({post_title:["",$.required],post_content:["",$.required],post_id:[""],select_status:[""],selectedCategory:[""],feature_image_id:[""]}),this.postservice.postStatusList().subscribe(d=>{this.post_status=d.map(v=>({name:v.name,code:v.slug}))}),this.postservice.postCategoryList().subscribe(d=>{this.categories=d,this.category_list=this.categories.map(v=>({name:v.name,code:v.id})),this.loadPosts()})}ngOnInit(){}loadPosts(){this.postId=Number(this.route.snapshot.paramMap.get("id"))||0;let e=0;this.postservice.getSinglePost(this.postId).subscribe({next:t=>{let i=this.category_list.filter(d=>t.categories?.includes(d.code));this.postservice.getPostFeatureImage(t.featured_media).subscribe(d=>{console.log(d.link),this.featureImageUrl=d.link});let n=this.post_status.find(d=>d.code===t.status);this.postForm.patchValue({post_title:t?.title?.rendered||"",post_content:t?.content?.rendered||"",post_id:t.id,select_status:n,selectedCategory:i})}})}onSubmit(){if(this.postForm.valid){let e={title:this.postForm.value.post_title,id:this.postForm.value.post_id,content:this.postForm.value.post_content,status:this.postForm.value.select_status.code,categories:this.postForm.value.selectedCategory.map(t=>t.code),featured_media:this.featureImageId||0};this.postservice.postUpdate(this.postForm.value.post_id,e).subscribe(t=>{console.log(t),this.showSuccess()})}}onFileSelect(e){this.uploadedFiles=[];for(let t of e.files)this.uploadedFiles.push(t);this.uploadedFiles.length>0&&this.uploadImage()}uploadImage(){if(this.uploadedFiles.length===0)return;this.uploadInProgress=!0;let e=this.uploadedFiles[0];this.postservice.uploadMedia(e).subscribe({next:t=>{this.featureImageId=t.id,this.featureImageUrl=t.source_url,this.postForm.patchValue({feature_image_id:t.id}),this.uploadInProgress=!1,this.messageService.add({severity:"success",summary:"Image Uploaded",detail:"Feature image uploaded successfully"})},error:t=>{console.error("Upload error:",t),this.uploadInProgress=!1,this.messageService.add({severity:"error",summary:"Upload Failed",detail:"Failed to upload image"})}})}removeImage(){this.featureImageUrl="",this.featureImageId=0,this.postForm.patchValue({feature_image_id:""})}showSuccess(){this.messageService.add({severity:"success",summary:"Post Updated",detail:"Post Updated Successfully"})}static{this.\u0275fac=function(t){return new(t||o)(f(ot),f(at),f(V),f(X))}}static{this.\u0275cmp=y({type:o,selectors:[["app-postedit"]],decls:37,vars:10,consts:[[1,"card","p-4"],[1,"text-center","mb-4"],[3,"ngSubmit","formGroup"],[1,"p-fluid","p-formgrid","p-grid","mb-4"],[1,"p-field","p-col-12","p-md-4"],["for","post_title",1,"p-d-block"],[1,"p-field","p-col-12","p-md-8"],["id","post_title","formControlName","post_title","type","text","placeholder","Enter post title",1,"p-inputtext","p-component","w-full","p-d-block"],["for","post_content",1,"p-d-block"],["formControlName","post_content"],["for","post_categories",1,"p-d-block"],["formControlName","selectedCategory","optionLabel","name","styleClass","w-full",3,"options","multiple"],[1,"p-field","mb-3"],[1,"font-bold","block","mb-2"],["class","mb-3",4,"ngIf"],[4,"ngIf"],["class","mt-3",4,"ngIf"],["for","select_status",1,"p-d-block"],["formControlName","select_status","optionLabel","name","placeholder","Select Status",1,"w-full",3,"options"],["type","hidden","formControlName","post_id"],[1,"text-center"],["type","submit","label","Submit","icon","pi pi-check",1,"p-button-success","w-full","sm:w-auto"],[1,"mb-3"],["alt","Feature Image",1,"border-round","shadow-2",2,"max-width","200px","max-height","200px",3,"src"],[1,"mt-2"],["icon","pi pi-trash","styleClass","p-button-danger p-button-sm","label","Remove Image",3,"onClick"],["mode","basic","chooseLabel","Browse","accept","image/*","styleClass","p-button-outlined",3,"onSelect","auto","maxFileSize"],[1,"block","mt-1","text-sm","text-600"],[1,"mt-3"],["mode","indeterminate"],[1,"block","mt-1","text-sm","text-blue-500"]],template:function(t,i){t&1&&(s(0,"div",0)(1,"h2",1),a(2,"Edit Post"),r(),s(3,"form",2),h("ngSubmit",function(){return i.onSubmit()}),s(4,"div",3)(5,"div",4)(6,"label",5),a(7,"Post Title:"),r()(),s(8,"div",6),m(9,"input",7),r()(),s(10,"div",3)(11,"div",4)(12,"label",8),a(13,"Post Content:"),r()(),s(14,"div",6),m(15,"p-editor",9),r()(),s(16,"div",3)(17,"div",4)(18,"label",10),a(19,"Post Categories:"),r()(),s(20,"div",6),m(21,"p-listbox",11),r()(),s(22,"div",12)(23,"label",13),a(24,"Feature Image"),r(),g(25,Ot,4,1,"div",14)(26,$t,4,2,"div",15)(27,Bt,4,3,"div",16),r(),s(28,"div",3)(29,"div",4)(30,"label",17),a(31,"Select Status:"),r()(),s(32,"div",6),m(33,"p-dropdown",18),r()(),m(34,"input",19),s(35,"div",20),m(36,"p-button",21),r()()()),t&2&&(l(3),p("formGroup",i.postForm),l(12),_(c(9,Dt)),l(6),p("options",i.category_list)("multiple",!0),l(4),p("ngIf",i.featureImageUrl),l(),p("ngIf",!i.featureImageUrl||!i.uploadInProgress),l(),p("ngIf",i.uploadInProgress),l(6),p("options",i.post_status))},dependencies:[M,et,dt,ct,nt,ht,ft,N,E,k,T,j,L],styles:[".card[_ngcontent-%COMP%]{background-color:#fff;box-shadow:0 4px 8px #0000001a;border-radius:8px;padding:20px}.p-field[_ngcontent-%COMP%]{display:flex;align-items:center}.p-inputtext[_ngcontent-%COMP%]{width:100%;padding:10px;border-radius:4px;border:1px solid #ccc;font-size:1rem}.p-button[_ngcontent-%COMP%]{font-weight:600;border-radius:4px;padding:10px 15px}.p-dropdown[_ngcontent-%COMP%]   .p-dropdown-label[_ngcontent-%COMP%]{color:#555}.image-preview[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{object-fit:cover}@media (max-width: 768px){.p-md-4[_ngcontent-%COMP%]{width:100%;margin-bottom:8px}.p-editor[_ngcontent-%COMP%]{height:250px}.p-inputtext[_ngcontent-%COMP%], .p-dropdown[_ngcontent-%COMP%]{font-size:.9rem}}"]})}}return o})();var Gt=[{path:"",component:vt},{path:"edit-post/:id",component:xt}],St=(()=>{class o{static{this.\u0275fac=function(t){return new(t||o)}}static{this.\u0275mod=I({type:o})}static{this.\u0275inj=P({imports:[B.forChild(Gt),B]})}}return o})();var ve=(()=>{class o{static{this.\u0275fac=function(t){return new(t||o)}}static{this.\u0275mod=I({type:o})}static{this.\u0275inj=P({imports:[J,St,gt,K,st]})}}return o})();export{ve as PostsModule};
